# 实验内容
### 增加 `iam()`和`whoami()`
1. 首先要在`system_call.s`中增加系统调用总数，从72改为74
```c
nr_system_calls = 74
```
2. 需要定义这两个调用，在`unistd.h`头文件中
```c
#define __NR_iam    72
#define __NR_whoami 73
```
3. 将这两个系统调用加入到调用表中`linux/sys.h`，注意此处的行号需要和刚刚定义的一致
```C
72 extern int sys_iam();
73 extern int sys_whoami();
```
然后在文件末尾的系统调用表中加入这两个调用
![image.png](https://s2.loli.net/2024/12/17/NDcbwEk9vZY5hOW.png)
4. 这两个调用在`who.c`中实现，所以需要在构建时构建该文件，在`Makefile`中修改
```
OBJS = ...省略 who.o

who.s who.o: who.c ../include/linux/kernel.h ../include/unistd.h
```
`who.c`中需要`kernel.h`和`unistd.h`的声明和定义
![image.png](https://s2.loli.net/2024/12/17/2A9vI1CoeVjkRzQ.png)
5. 实现`kernel/who.c`的代码，主要思路是利用`asm/segment.h`中的`get_fs_byte`和`put_fs_byte`函数，实现将用户空间中的数据，此处为`name`，拷贝到内核空间中。